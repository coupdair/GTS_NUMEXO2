##EPICS server

#edit
gitk --all &
gedit _info.txt gtsApp/src/gtsMain.cpp gtsApp/src/dbSubExample.c iocBoot/iocgts/st.cmd &

#hand compile
rm bin/*/* Linux-*/*
##compile device and UDP objects
make -f Makefile.target
##compile EPICS objects
make
cd /home/coudert/GTS_server/GTS_NUMEXO2/gtsApp/src/O.linux-ppc/
##link all device, EPICS and UDP (e.g. with gtsMisc.o)
/space/global/buildroot/CentOS6_64/ppc440/buildroot-2013.11/output/host/usr//bin/powerpc-buildroot-linux-gnu-g++ -o gts -Wl,-Bstatic -L/home/coudert/GTS_server/GTS_NUMEXO2/lib/linux-ppc -L/space/global/buildroot/CentOS6_64/ppc440/epics/base-3.15.5/lib/linux-ppc -Wl,-rpath,/home/coudert/GTS_server/GTS_NUMEXO2/lib/linux-ppc -Wl,-rpath,/space/global/buildroot/CentOS6_64/ppc440/epics/base-3.15.5/lib/linux-ppc -rdynamic -L/space/global/buildroot/CentOS6_64/ppc440/buildroot-2013.11/output/host/usr//powerpc-buildroot-linux-gnu/lib gts_registerRecordDeviceDriver.o gtsMain.o -lgtsSupport -ldbRecStd -ldbCore -lca -lCom -Wl,-Bdynamic -lpthread -lm -lrt -ldl -lgcc /home/coudert/GTS_server/GTS_NUMEXO2/Linux-ppc440/gtsMisc.o
##copy binary
cp -p gts ../../../bin/linux-ppc/
cd ../../../
./bin/linux-x86_64/gts --help && ./bin/linux-x86_64/gts --version
./doxygen.sh

#run PPC

##transfert
##pack
rm gts.zip ; zip -ry9 gts.zip db dbd ; zip -j gts.zip bin/linux-ppc/gts iocBoot/iocgts/st.cmd iocBoot/iocgts/envPaths
rsync -var gts.zip ganp1012:/tmp/   
rsync -var /tmp/gts.zip numexo2@numexo2-11:/tmp/   

##embedded
###driver
#disable periodic message on standard output
echo 0 > /sys/module/rdp_fifo_driver/parameters/debug_level
###unpack
cd /tmp/
unzip -o gts.zip 
###server
./gts -e -c st.cmd
#var mySubDebug 0

##client
setenv EPICS_CA_ADDR_LIST "10.10.17.255"
setenv EPICS_CA_AUTO_ADDR_LIST NO
setenv EPICS_CAS_BEACON_ADDR_LIST "10.10.17.255"
##client
./bin/linux-x86_64/caget coudert:subExample


#run x86

cd iocBoot/iocgts/; ../../bin/linux-x86_64/gts --epics -c st.cmd; cd ../..
###epics> dbl; var mySubDebug 0; exit

/space/global/buildroot/CentOS6_64/ppc440/epics/base/bin/linux-x86_64/caget coudert:subExample
/space/global/buildroot/CentOS6_64/ppc440/epics/base/bin/linux-x86_64/caput coudert:subExample 123.456



exit
##UDP server

#compile
make

#get version (on host computer, else on target call "gtsServer -v")
strings Linux-ppc440/gtsServer | grep 'v.\..\..' > VERSION
###or
nt12 /usr/local/bin/gtsServer -v | tail -c 8 > VERSION

#documentation
./doxygen.sh

exit

#single CL
make && make -f Makefile.host ; strings Linux-ppc440/gtsServer | grep 'v.\..\..' > VERSION ; set VERSION=`cat VERSION` ; cat Doxyfile.template | sed "s/##VERSION##/$VERSION/" > Doxyfile ; ./Linux-x86-64/gtsServer -h > gtsServer.help.output ; doxygen ; firefox doc/html/index.html &

exit

#EPICS interface
/space/global/buildroot/CentOS6_64/ppc440/epics/base/bin/linux-x86_64/makeBaseApp.pl -t example gts
/space/global/buildroot/CentOS6_64/ppc440/epics/base/bin/linux-x86_64/makeBaseApp.pl -t example -i -a linux-x86_64 gts

