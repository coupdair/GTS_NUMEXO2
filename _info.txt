##example
# - SCAN passive
# - ->val float
# - add sub:
#   1. dbSubExample.c:
#     - func(
#     - epicsRegisterFunction(func
#   2. dbSubExample.dbd:
#     - function(func
#   3. dbSubExample.db:
#     - field(SNAM,"func
#   o. see gtsApp/src/funcEPICS.sh

#edit
gitk --all &
gedit _info.txt gtsApp/src/gtsMain.cpp gtsApp/src/dbSubExample.c iocBoot/iocgts/st.cmd &

#GTS (EPICS or UDP)
./make.sh

#transfert
cp -p /space/global/buildroot/CentOS6_64/ppc440/epics/base-3.15.5/bin/linux-ppc/caRepeater bin/linux-ppc/
rm gts.zip ; zip -ry9 gts.zip db dbd ; zip -j gts.zip bin/linux-ppc/gts iocBoot/iocgts/st.cmd iocBoot/iocgts/envPaths bin/linux-ppc/caRepeater

#run
##x86
bin/linux-x86_64/gts --epics -c iocBoot/iocgts/st.cmd
# v
dbl
numexo2:subExample
numexo2:gtsExample
Record numexo2:subExample called mySubProcess(0x22fbb10/1.000000) #0 S1
...
# v
~/bin/caput numexo2:subExample 1
...

##ppc
./gts --epics -c st.cmd

##PPC server
setenv EPICS_CA_ADDR_LIST '10.10.17.127'
#setenv EPICS_CA_AUTO_ADDR_LIST 'NO'

##x86 server
setenv EPICS_CA_ADDR_LIST '10.10.17.254'
setenv EPICS_CAS_BEACON_ADDR_LIST '10.10.17.254'

~/bin/caget numexo2:serverVersion.DESC
numexo2:serverVersion.DESC     v0.1.4f

~/bin/caput numexo2:gtsTest 1
Old : numexo2:gtsTest                0
New : numexo2:gtsTest                127

~/bin/caput numexo2:coarseDelaySet 0
~/bin/caput numexo2:coarseDelaySet.A 1234
~/bin/caput numexo2:coarseDelaySet 1
Old : numexo2:coarseDelaySet         0
New : numexo2:coarseDelaySet         1

~/bin/caget numexo2:alignMeas.DESC
~/bin/caput numexo2:alignMeas 0
~/bin/caput numexo2:alignMeas.A 1
~/bin/caput numexo2:alignMeas.B 123
~/bin/caput numexo2:alignMeas 1

~/bin/caput numexo2:treeSetup 0
~/bin/caput numexo2:treeSetup.A 1    
~/bin/caput numexo2:treeSetup 1

~/bin/caput numexo2:treeSetup 0
~/bin/caput numexo2:treeSetup.A 2    
~/bin/caput numexo2:treeSetup 1
Ctrl+C

epics> dbl
numexo2:subExample
numexo2:gtsExample
numexo2:serverVersion
numexo2:gtsReset
numexo2:gtsInit
numexo2:gtsTest
numexo2:gtsUpdate
numexo2:conIs
numexo2:gtsIs
numexo2:treeStart
numexo2:treeStop
numexo2:includeCarrierForAlign
numexo2:excludeCarrierForAlign
numexo2:alignStart
numexo2:treeSetup
numexo2:rxSystemIsReady
numexo2:treeRead
numexo2:fineDelaySetNow
numexo2:fineDelaySet
numexo2:coarseDelaySet
numexo2:triggerStart
numexo2:alignSet
numexo2:alignMeas
numexo2:triggerSetup
numexo2:tdcSet
numexo2:tdcMeas

epics> dbpr numexo2:serverVersion
...
D: 0                DESC: v0.1.4f       DISA: 0             DISP: 0             
...
epics>

Record numexo2:gtsTest called gtsTestEPICS(0x10705f68/1.000000)activated_if_1
gts 127 is being test

Record numexo2:coarseDelaySet called coarseDelaySetEPICS(0x10440a18/0.000000)
Record numexo2:coarseDelaySet called coarseDelaySetEPICS(0x10440a18/0.000000)
Record numexo2:coarseDelaySet called coarseDelaySetEPICS(0x10440a18/1.000000)
gts 127 is being coarseDelay using delay=1234

Record numexo2:treeSetup called treeSetupEPICS(0x1043f168/0.000000)
Record numexo2:treeSetup called treeSetupEPICS(0x1043f168/0.000000)
Record numexo2:treeSetup called treeSetupEPICS(0x1043f168/1.000000)
gts 127 is being setup using step=1

Record numexo2:treeSetup called treeSetupEPICS(0x1043f168/0.000000)
Record numexo2:treeSetup called treeSetupEPICS(0x1043f168/0.000000)
Record numexo2:treeSetup called treeSetupEPICS(0x1043f168/1.000000)
gts 127 is being setup using step=2
###Â locked ###

exit

#clean
rm -fr configure include iocBoot gtsApp lib db dbd Makefile bin

#example
/space/global/buildroot/CentOS6_64/ppc440/epics/base/bin/linux-x86_64/makeBaseApp.pl -t example gts
/space/global/buildroot/CentOS6_64/ppc440/epics/base/bin/linux-x86_64/makeBaseApp.pl -t example -i -p gts -a linux-x86_64 gts
make

#a few random
Kernel panic - not syncing: Fatal exception in interrupt

